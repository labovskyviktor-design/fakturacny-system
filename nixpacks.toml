[phases.setup]
nixPkgs = ["python311", "gcc", "postgresql", "wkhtmltopdf", "xvfb", "xorg.libX11", "xorg.libXrender", "xorg.libXext", "fontconfig", "dejavu_fonts"]

[phases.install]
cmds = ["pip install -r requirements.txt"]

[variables]
PYTHONPATH = "."
# Autoritatívne cesty k binárkam v Nix prostredí
WKHTMLTOPDF_PATH = "/nix/var/nix/profiles/default/bin/wkhtmltopdf"
XVFB_PATH = "/nix/var/nix/profiles/default/bin/xvfb-run"
# Pridáme stabilný profil do PATH
PATH = "/nix/var/nix/profiles/default/bin:$PATH"
LD_LIBRARY_PATH = "/nix/var/nix/profiles/default/lib:$LD_LIBRARY_PATH"

[start]
cmd = "gunicorn app:app --bind 0.0.0.0:$PORT --workers 1 --threads 4 --timeout 120"
